/*! BucketJS v1.1.0 | (c) 2014 Tushar Singh.License: MIT */
!function(){var a=function(a){this.bucketName=a?a:""};window.bucket=function(b){return new a(b)},bucket.config={suffix:"Bucket",getterMode:1},bucket.setting=function(a,b){if("object"==typeof a)for(var c in a)bucket.config[c]&&(bucket.config[c]=a[c]);else void 0!==a&&void 0!==b&&void 0!==bucket.config[a]&&(bucket.config[a]=b)};var b={isBucket:function(a,b){var c=a.indexOf(void 0==b?'["'+bucket.config.suffix+'",':'["'+bucket.config.suffix+'","'+b);return 0==c?!0:!1},parse:function(a){try{return JSON.parse(a)}catch(b){if(null!=a&&void 0!=a){if("true"==a)return!0;if("false"==a)return!1;if(/^[0-9]+.[0-9]+$/.test(a))return Number(a);if("null"==a)return null;if("undefined"==a)return void 0}return a}}};a.prototype={set:function(a,b,c){if(void 0!==b){var d,e,f;if($value="object"==typeof b?[JSON.stringify(b)]:[b],d=[bucket.config.suffix,this.bucketName,a],e=typeof b,f={bucket:this.bucketName,value:b,key:a,dataType:e},$value.push(e),c&&c.age){var g=new Date;g.setSeconds(g.getSeconds()+c.age),$value.push(JSON.stringify(g));var h=void 0==localStorage["Bucket--ExpKeys"]?0:Number(localStorage["Bucket--ExpKeys"]);localStorage["Bucket--ExpKeys"]=h+1,f.age=c.age,f.expiryDate=g}localStorage[JSON.stringify(d)]=JSON.stringify($value);for(var i=0,j=bucket.events.set.length;j>i;i++)bucket.events.set[i](f);return b}return!1},get:function(a){if(a){var c=JSON.stringify([bucket.config.suffix,this.bucketName,a]),d=localStorage[c],e,f,g;if(void 0!==d){if(e=JSON.parse(d),f=e[0],dataType=e[1],1===bucket.config.getterMode&&void 0!==dataType){if("number"==dataType)return Number(f);if("object"==dataType)return JSON.parse(f);if("boolean"==dataType){if("true"==f)return!0;if("false"==f)return!1}else{if("undefined"==dataType)return void 0;if("function"==dataType)return f}return f}return b.parse(f)}return void 0}return bucket.get(this.bucketName)},remove:function(a){var b={bucket:this.bucketName,key:a};if(a){localStorage.removeItem(JSON.stringify([bucket.config.suffix,this.bucketName,a]));var c=void 0==localStorage["Bucket--ExpKeys"]?0:Number(localStorage["Bucket--ExpKeys"]);c>0&&(localStorage["Bucket--ExpKeys"]=c-1)}else bucket.remove(this.bucketName);for(var d=0,e=bucket.events.remove.length;e>d;d++)bucket.events.remove[d](b)}},bucket.events={set:[],remove:[]},bucket.on=function(a,b){a=a.toLowerCase(),bucket.events[a]?bucket.events[a].push(b):console.error('Bucket: Invalid event "'+a+'"')},bucket.get=function(a){var c={};if(void 0==a){for(var d in localStorage)if(b.isBucket(d)){var e;e=JSON.parse(d),a=e[1],thisBucket=bucket(a),f=e[2],void 0==c[a]&&(c[a]={}),c[a][f]=thisBucket.get(f)}}else for(var d in localStorage)if(b.isBucket(d,a)){var e,f;e=JSON.parse(d),a=e[1],f=e[2],c[f]=bucket(a).get(f)}for(var g in c)if(c.hasOwnProperty(g))return c;return void 0},bucket.remove=function(a){if(void 0==a)throw new Error("Bucket: bucketName not defined");for(var c in localStorage)if(b.isBucket(c,a)){var d=JSON.parse(c);bucket(d[1]).remove(d[2])}},bucket.removeExpired=function(a){var c=void 0!==a?a:new Date;for(var d in localStorage)if(b.isBucket(d)){var e=JSON.parse(localStorage[d]);if(3==e.length){var f=JSON.parse(d),g=f[1],h=f[2],i=new Date(JSON.parse(e[2])),j=i.getTime()-c.getTime();0>=j&&bucket(g).remove(h)}}},Number(localStorage["Bucket--ExpKeys"])>0&&bucket.removeExpired()}();
//# sourceMappingURL=bucket.min.map