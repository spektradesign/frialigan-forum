!function(t){"use strict";phpbb.addAjaxCallback("slickthemes.resetStorage",function(t){for(var a in localStorage)0==a.indexOf("st_canvas_")&&localStorage.removeItem(a)}),phpbb.addAjaxCallback("slickthemes.themeconfig_save",function(t){t.success?phpbb.alert(t.MESSAGE_TITLE,t.MESSAGE_TEXT):phpbb.alert(t.MESSAGE_TITLE,t.MESSAGE_TEXT)}),phpbb.addAjaxCallback("mark_forums_read",function(a){var e=a.NO_UNREAD_POSTS,o=a.UNREAD_POSTS,i={forum_unread:"forum_read",forum_unread_subforum:"forum_read_subforum",forum_unread_locked:"forum_read_locked"};t(".category-forumlist").find('.forumrow[class*="forum_unread"]').each(function(){var a=t(this),r=a.attr("class");for(var n in i){var s=i[n];r.replace(n,s)}a.attr("class",r),a.children('.forum-icon[title="'+o+'"]').attr("title",e)}),t('a.subforum[class*="unread"]').removeClass("unread").addClass("read"),t("#active_topics").length&&phpbb.ajaxCallbacks.mark_topics_read.call(this,a,!1),t('[data-ajax="mark_forums_read"]').attr("href",a.U_MARK_FORUMS),phpbb.closeDarkenWrapper(3e3)}),phpbb.addAjaxCallback("mark_topics_read",function(a,e){var o,i=(a.NO_UNREAD_POSTS,a.UNREAD_POSTS,{global_unread:"global_read",announce_unread:"announce_read",sticky_unread:"sticky_read",topic_unread:"topic_read"}),r=["","_hot","_hot_mine","_locked","_locked_mine","_mine"],n={},s=[];"undefined"==typeof e&&(e=!0),t.each(i,function(a,e){t.each(r,function(t,o){return"_hot"!==o&&"_hot_mine"!==o||"topic_unread"===a?(n[a+o]=e+o,void s.push(a+o)):!0})}),o="."+s.join(",."),t(".topiclist, .itemlist--topics").find(o).each(function(){var a=t(this);if(1!=a.find(".globaltopic-parentforum").length){a.find(".topic-firstunread").replaceWith('<span class="topic-firstunread">&nbsp;</span>');var e=a.attr("class");for(var o in n){var i=n[o];e=e.replace(o,i)}a.attr("class",e)}}),e&&t('[data-ajax="mark_topics_read"]').attr("href",a.U_MARK_TOPICS),phpbb.closeDarkenWrapper(3e3)}),phpbb.addAjaxCallback("notification.mark_all_read",function(a){"undefined"!=typeof a.success&&(phpbb.markNotifications(t("#notification_list li.bg2"),0),phpbb.closeDarkenWrapper(3e3))}),phpbb.addAjaxCallback("notification.mark_read",function(a){if("undefined"!=typeof a.success){var e=Number(t("#notification_list_button strong").html())-1;phpbb.markNotifications(t(this).parent("li.bg2"),e)}}),phpbb.markNotifications=function(a,e){a.removeClass("bg2 unread"),a.find("a.notification-mark-read").remove(),a.each(function(){var a=t(this).find("a");a.attr("href",a.attr("data-real-url"))});var o=t("#notification_list_button"),i=o.find(".notification-count"),r=1e3*parseFloat(i.css("transition-duration"))+10,n=t(".user-view-notifications");i.html(e);var s=o.attr("title").replace(/(\d+)/g,e);o.attr("title",s),0==e&&(i.addClass("bubble-out"),setTimeout(function(){i.remove(),n.removeClass("has-unread")},r)),e||t("#mark_all_notifications").remove(),t("title").text((e?"("+e+")":"")+t("title").text().replace(/(\(([0-9])\))/,""))},phpbb.addAjaxCallback("post_delete",function(){var a,e=t(this);if(void 0===e.attr("data-refresh")){a=e[0].href.split("&p=")[1];var o=e.parents("#p"+a).css("pointer-events","none");if(o.hasClass("bg1")||o.hasClass("bg2")){var i=o.nextAll(".bg1");o.nextAll(".bg2").removeClass("bg2").addClass("bg1"),i.removeClass("bg1").addClass("bg2")}o.fadeOut(function(){t(this).remove()})}}),phpbb.addAjaxCallback("post_visibility",function(a){var e=a.visible?t(this):t(this).parents(".post");t(e).css("pointer-events","none").fadeOut(function(){t(this).remove()}),a.visible&&e.parents(".post").find(".post_deleted_msg").css("pointer-events","none").fadeOut(function(){t(this).remove()})}),phpbb.addAjaxCallback("row_delete",function(){t(this).parents("tr").remove()}),phpbb.addAjaxCallback("zebra",function(a){a.success&&t(".zebra").html('<div class="alert alert-success">'+a.MESSAGE_TEXT+"</div>")}),phpbb.addAjaxCallback("vote_poll",function(a){if("undefined"!=typeof a.success){var e=t(".topic_poll"),o=e.find(".resultbar").is(":visible"),i=0;o||e.find(".poll_view_results").hide(500),a.can_vote?e.find(".resultbar, .poll_option_percent, .poll_total_votes").show(500):e.find(".polls, .poll_max_votes, .poll_vote, .poll_option_select").fadeOut(500,function(){e.find(".resultbar, .poll_option_percent, .poll_total_votes").show()}),e.find("[data-poll-option-id]").each(function(){var e=t(this),o=e.attr("data-poll-option-id");i=a.vote_counts[o]>=i?a.vote_counts[o]:i}),e.find(".poll_total_vote_cnt").html(a.total_votes),e.find("[data-poll-option-id]").each(function(){var e=t(this),o=e.attr("data-poll-option-id"),r="undefined"!=typeof a.user_votes[o],n=a.vote_counts[o]===i,s=a.total_votes?Math.round(a.vote_counts[o]/a.total_votes*100):0,l=0===i?0:Math.round(a.vote_counts[o]/i*100);e.toggleClass("voted",r),e.toggleClass("most-votes",n);var c=e.find(".resultbar .progress-bar"),d=a.can_vote?500:1500;setTimeout(function(){c.animate({width:l+"%"},500);var t=s?a.vote_counts[o]+" ("+s+"%)":a.NO_VOTES;e.find(".poll_option_percent").html(t)},d)}),a.can_vote||e.find(".polls").delay(400).fadeIn(500);var r=a.can_vote?300:900;e.find(".vote-submitted").delay(r).slideDown(200,function(){t(this).delay(5e3).slideUp(500)})}}),t(".poll_view_results a").click(function(a){a.preventDefault();var e=t(this).parents(".topic_poll");e.removeClass("result-hidden"),e.find(".resultbar, .poll_option_percent, .poll_total_votes").show(500),e.find(".poll_view_results").hide(500)}),t("[data-ajax]").each(function(){var a=t(this),e=a.attr("data-ajax"),o=a.attr("data-filter");if("false"!==e){var i="true"!==e?e:null;o=void 0!==o?phpbb.getFunctionByName(o):null,phpbb.ajaxify({selector:this,refresh:void 0!==a.attr("data-refresh"),filter:o,callback:i})}}),t("#qr_full_editor").click(function(){t("#qr_postform").attr("action",function(t,a){return a+"#preview"})}),t(".display_post").click(function(a){a.preventDefault();var e=t(this).attr("data-post-id");t("#post_content"+e).show(),t("#profile"+e).show(),t("#post_hidden"+e).hide()}),t("#member_search").click(function(){var a=t("#memberlist_search");return a.slideToggle("fast"),phpbb.ajaxCallbacks.alt_text.call(this),a.is(":visible")&&t("#username").focus(),!1}),t(function(){phpbb.resizeTextArea(t("textarea:not(#message-box textarea, .no-auto-resize)"),{minHeight:75,maxHeight:250}),phpbb.resizeTextArea(t("#message-box textarea"))})}(jQuery);